({851:function(){var e=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function s(e){try{a(o.next(e))}catch(e){i(e)}}function c(e){try{a(o.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,c)}a((o=o.apply(e,t||[])).next())}))};chrome.runtime.onMessage.addListener(((t,n,o)=>{if("LIKE_VIDEO"===t.type){const{videoId:e,accessToken:n}=t.payload;return fetch("https://www.googleapis.com/youtube/v3/videos/rate",{method:"POST",headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"},body:JSON.stringify({id:e,rating:"like"})}).then((e=>!0)).then((()=>{o({success:!0,videoId:e})})).catch((e=>{console.error("Error in liking the video:",e),o({success:!1,error:e.message})})),!0}if("COMMENT_VIDEO"===t.type){const{videoId:e,commentText:n,accessToken:r}=t.payload,i={snippet:{topLevelComment:{snippet:{textOriginal:n}},videoId:e}};return fetch("https://www.googleapis.com/youtube/v3/commentThreads?part=snippet",{method:"POST",headers:{Authorization:`Bearer ${r}`,"Content-Type":"application/json"},body:JSON.stringify(i)}).then((e=>{if(!e.ok)throw new Error(`HTTP error! Status: ${e.status}`);return e.json()})).then((e=>{o({success:!0,data:e})})).catch((e=>{console.error("Error posting comment:",e),o({success:!1,error:e.message})})),!0}if("FETCH_CHANNEL_ID_AND_SUBSCRIBE"===t.type){const{handle:n,accessToken:r}=t.payload;return function(t,n){return e(this,void 0,void 0,(function*(){const o=yield function(t,n){return e(this,void 0,void 0,(function*(){const e=`https://www.googleapis.com/youtube/v3/channels?part=id&forHandle=${t}&key=AIzaSyBjUc6_XRFUCZqQpxzUyC26rnznsJQYTfo`,n=yield fetch(e),o=yield n.json();if(o.items&&o.items.length>0)return o.items[0].id;throw new Error(`No channel found for handle: ${t}`)}))}(t);if(!o)throw new Error(`Channel ID not found for handle: ${t}`);return yield function(t,n,o){return e(this,void 0,void 0,(function*(){const e=yield fetch("https://www.googleapis.com/youtube/v3/subscriptions?part=snippet",{method:"POST",headers:{Authorization:`Bearer ${o}`,"Content-Type":"application/json"},body:JSON.stringify({snippet:{resourceId:{channelId:t}}})});if(!e.ok){const t=yield e.json();throw new Error(`Subscription API failed: ${t.error.message}`)}return yield e.json()}))}(o,0,n)}))}(n,r).then((e=>{o({success:!0,data:e})})).catch((e=>{o({success:!1,error:e.message})})),!0}}))}})[851]();